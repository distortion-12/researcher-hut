# ============================================
# SECURITY CONFIGURATION - RESEARCHER.HUT
# ============================================

# ---- SERVER ----
PORT=5000
NODE_ENV=production

# ---- DATABASE (Supabase) ----
SUPABASE_URL=your_supabase_url
SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key

# ---- ADMIN CONFIGURATION ----
# SECURITY: Set these via environment variables in production
# NOT in .env file for security
ADMIN_EMAIL=your_admin_email
# ADMIN_PASSWORD will be set/reset via the admin panel

# ---- EMAIL CONFIGURATION ----
# Using Resend.com for email (recommended)
RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxx

# ---- SECURITY TOKENS ----
# CRITICAL: Generate strong random secrets
# Generate OTP_SECRET with: openssl rand -base64 32
OTP_SECRET=your-strong-random-secret-for-otp-encryption

# Generate ADMIN_SECRET_TOKEN with: openssl rand -hex 32
ADMIN_SECRET_TOKEN=your-admin-secret-token-for-api-protection

# ---- CLIENT URLS (for CORS) ----
CLIENT_URL=https://researcher-hut.vercel.app

# ============================================
# SECURITY BEST PRACTICES
# ============================================
#
# 1. NEVER commit real .env to git
#    - Use .env.local for local development
#    - Add .env to .gitignore
#
# 2. Environment Variable Management:
#    - Use hosting provider dashboards (Vercel, Render)
#    - Never hardcode secrets in code
#    - Rotate secrets regularly
#
# 3. SUPABASE_SERVICE_ROLE_KEY Security:
#    - Keep server-side only (never expose to client)
#    - Use for admin operations only
#    - Store in secure secret manager
#
# 4. Password Hashing:
#    - Uses bcryptjs with 12 salt rounds
#    - OTPs are encrypted before storage
#    - Never log passwords or OTPs
#
# 5. CORS Configuration:
#    - Only allow specific frontend URLs
#    - Don't use wildcard '*' in production
#    - Enable credentials only for trusted origins
#
# 6. Rate Limiting:
#    - 3 OTP requests per email per 5 minutes
#    - 100 general requests per IP per 15 minutes
#    - Adjust in middleware/auth.ts as needed
#
# 7. Monitoring & Logging:
#    - Don't log sensitive data (passwords, OTPs, tokens)
#    - Monitor for brute force attempts
#    - Set up alerts for suspicious activity
#
# ============================================
